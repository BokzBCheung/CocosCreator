require=function e(t,n,a){function c(i,s){if(!n[i]){if(!t[i]){var r="function"==typeof require&&require;if(!s&&r)return r(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return c(n?n:e)},l,l.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)c(a[i]);return c}({CommonUserDis:[function(e,t,n){"use strict";cc._RFpush(t,"0735cP+h7tKnJKydwamoB9n","CommonUserDis"),t.exports={distance:{userCount:null,shakeNum:null,distancePerShake:null}},cc._RFpop()},{}],CommonUserIfo:[function(e,t,n){"use strict";cc._RFpush(t,"ce0443ulApFk6xC/myLyruf","CommonUserIfo"),t.exports={data:{userNum:null,command:null,userName:null}},cc._RFpop()},{}],GameOver:[function(e,t,n){"use strict";cc._RFpush(t,"2ed21Zk38JFrb0XdmRGPU0/","GameOver");var a=e("CommonUserDis");cc.Class({"extends":cc.Component,properties:{newUserPrefab:{"default":null,type:cc.Prefab},newHorsePrefab:{"default":null,type:cc.Prefab},scoreLabel:{"default":null,type:cc.Label}},onLoad:function(){this.initSprite(),cc.log(a.distance)},initSprite:function(){var e=cc.instantiate(this.newUserPrefab),t=cc.instantiate(this.newHorsePrefab);a.distance.shakeNum<=5&&(a.distance.shakeNum-=2);for(var n=0;n<a.distance.userCount;n++)e.setPosition(cc.p(-210,525-92*n)),t.setPosition(cc.p(a.distance.shakeNum*a.distance.distancePerShake+80,525-92*n)),this.node.addChild(e),this.node.addChild(t);this.scoreLabel.string=Math.ceil(a.distance.shakeNum*a.distance.distancePerShake+80)}}),cc._RFpop()},{CommonUserDis:"CommonUserDis"}],Gaming:[function(e,t,n){"use strict";cc._RFpush(t,"9f25dQ4WYJPxaSjNmzQ35KO","Gaming");var a=e("CommonUserIfo"),c=e("CommonUserDis");cc.Class({"extends":cc.Component,properties:{newHorse2:null,newUser:null,horseSpritePrefab:{"default":null,type:cc.Prefab},queueArray:{"default":null,type:cc.Array},userCount:null,horseAudio:{"default":null,url:cc.AudioClip},userIfoPrefab:{"default":null,type:cc.Prefab},winsize:null,gameData:null},onLoad:function(){cc.log(a.data.userNum),c.distance.userCount=a.data.userNum,this.winsize=this.node.width,this.gameData=JSON.parse(cc.sys.localStorage.getItem("gameData")),""==this.gameData.shakeNum&&(this.gameData.shakeNum="300"),this.initSprite(),this.addListener()},addListener:function(){this.queueArray=[];var e=1;cc.inputManager.setAccelerometerInterval(1/7),cc.inputManager.setAccelerometerEnabled(!0);var t={event:cc.EventListener.ACCELERATION,callback:function(t,n){var a=n.getCurrentTarget();a=a.getComponent("Gaming"),this.x=t.x,this.y=t.y,this.z=t.z;var o=a.queueArray.length;7>o?(a.queueArray.push({xPos:t.x,yPos:t.y,zPos:t.z}),cc.log("array:",a.queueArray),a.isShake(this.x,this.y,this.z)?(e++,c.distance.shakeNum=e/4,c.distance.distancePerShake=a.winsize/a.gameData.shakeNum/5,a.newHorse2.x+=a.winsize/a.gameData.shakeNum/5,cc.audioEngine.playEffect(a.horseAudio,!1),a.queueArray.splice(0,o)):cc.audioEngine.pauseAllEffects()):a.queueArray.splice(0,o)}};cc.log("array:",this.queueArray),cc.eventManager.addListener(t,this.node)},initSprite:function(){cc.log(a.data.userName);for(var e=0;e<a.data.userNum;e++)this.newHorse2=cc.instantiate(this.horseSpritePrefab),this.newUser=cc.instantiate(this.userIfoPrefab),this.newHorse2.setPosition(cc.p(-280,520+-92*e)),this.newUser.setPosition(cc.p(-150,525+-92*e)),this.newUser.children[0].getComponent(cc.Label).string="["+a.data.userName[2*e+2].substr(0,8)+"]",this.node.addChild(this.newHorse2),this.node.addChild(this.newUser)},isShake:function(e,t,n){for(var a=0;a<this.queueArray.length;a++)return Math.abs(this.queueArray[a].xPos-e)>.2||Math.abs(this.queueArray[a].yPos-t)>.2||Math.abs(this.queueArray[a].zPos-n)>.2?(e=this.queueArray[a].xPos,t=this.queueArray[a].yPos,n=this.queueArray[a].zPos,!0):!1},update:function(e){this.newHorse2.x>this.winsize/2-120&&(cc.director.loadScene("GameOver"),cc.audioEngine.pauseAllEffects(),cc.audioEngine.unloadEffect(cc.horseAudio)),c.distance.shakeNum++}}),cc._RFpop()},{CommonUserDis:"CommonUserDis",CommonUserIfo:"CommonUserIfo"}],Index:[function(e,t,n){"use strict";cc._RFpush(t,"9ccdb+bf0xCUb+VflvRAu7h","Index"),cc.Class({"extends":cc.Component,properties:{StartBtn:{"default":null,type:cc.Button},clickPlayAudio:{"default":null,url:cc.AudioClip}},onLoad:function(){this.startCallBack(event)},startCallBack:function(e){cc.log("StartBtn:",this),this.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){var t=e.getCurrentTarget();t=t.getComponent("Index"),cc.audioEngine.playEffect(t.clickPlayAudio,!1),cc.director.loadScene("Setting")}),this.node.on(cc.Node.EventType.TOUCH_START,function(e){var t=e.getCurrentTarget();t=t.getComponent("Index"),cc.audioEngine.playEffect(t.clickPlayAudio,!1),cc.director.loadScene("Setting")})},commandCallBack:function(){cc.log(this.node)}}),cc._RFpop()},{}],"Setting-BacBtn":[function(e,t,n){"use strict";cc._RFpush(t,"5b2c8nFtstKW5ehhZBhy6aE","Setting-BacBtn"),cc.Class({"extends":cc.Component,properties:{BackBtn:{"default":null,type:cc.Button}},onLoad:function(){this.backCallBack(event)},backCallBack:function(e){this.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){cc.director.loadScene("Index")}),this.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.loadScene("Index")})}}),cc._RFpop()},{}],"Setting-EditBox":[function(e,t,n){"use strict";cc._RFpush(t,"0169fjydXlEKrEM01n82dQK","Setting-EditBox"),cc.Class({"extends":cc.Component,properties:{gameData:null,NameEd:{"default":null,type:cc.EditBox},ShakeNumEd:{"default":null,type:cc.EditBox},CommandEd:{"default":null,type:cc.EditBox}},onLoad:function(){this.gameData={name:"",shakeNum:"300",command:"",user:"Admin"},cc.sys.localStorage.setItem("gameData",JSON.stringify(this.gameData)),cc.log(this.gameData)},NameEdCallBack:function(){this.gameData={name:this.NameEd.string,shakeNum:this.ShakeNumEd.string,command:this.CommandEd.string,user:"Admin"},cc.sys.localStorage.setItem("gameData",JSON.stringify(this.gameData)),cc.log(this.gameData)},ShakeNumEdCallBack:function(){this.gameData={name:this.NameEd.string,shakeNum:this.ShakeNumEd.string,command:this.CommandEd.string,user:"Admin"},cc.sys.localStorage.setItem("gameData",JSON.stringify(this.gameData)),cc.log(this.gameData)},CommandEdCallBack:function(){this.gameData={name:this.NameEd.string,shakeNum:this.ShakeNumEd.string,command:this.CommandEd.string,user:"Admin"},cc.sys.localStorage.setItem("gameData",JSON.stringify(this.gameData)),cc.log(this.gameData)}}),cc._RFpop()},{}],"Setting-SubBtn":[function(e,t,n){"use strict";cc._RFpush(t,"93034PECJVJE62cw482XQ7i","Setting-SubBtn"),cc.Class({"extends":cc.Component,properties:{SubmitBtn:{"default":null,type:cc.Button},NameEd:{"default":null,type:cc.EditBox},ShakeNumEd:{"default":null,type:cc.EditBox},CommandEd:{"default":null,type:cc.EditBox},clickAudio:{"default":null,url:cc.AudioClip},DataTemp:null},onLoad:function(){this.startCallBack(event)},startCallBack:function(e){this.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){var t=e.getCurrentTarget();t=t.getComponent("Setting-SubBtn"),cc.audioEngine.playEffect(t.clickAudio,!1),cc.director.loadScene("Waiting")}),this.node.on(cc.Node.EventType.TOUCH_START,function(e){var t=e.getCurrentTarget();t=t.getComponent("Setting-SubBtn"),cc.audioEngine.playEffect(t.clickAudio,!1),cc.director.loadScene("Waiting")})}}),cc._RFpop()},{}],"Waiting-BacBtn":[function(e,t,n){"use strict";cc._RFpush(t,"f457debQaZP0o0zbY5xgp5e","Waiting-BacBtn"),cc.Class({"extends":cc.Component,properties:{BackBtn:{"default":null,type:cc.Button}},onLoad:function(){this.startCallBack(event)},startCallBack:function(e){this.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){cc.director.loadScene("Setting")}),this.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.loadScene("Setting")})}}),cc._RFpop()},{}],"Waiting-GoBtn":[function(e,t,n){"use strict";cc._RFpush(t,"5acc6Qkj0hEvLmsNCMEivZS","Waiting-GoBtn"),cc.Class({"extends":cc.Component,properties:{GoBtn:{"default":null,type:cc.Button},clickAudio:{"default":null,url:cc.AudioClip}},onLoad:function(){this.startCallBack(event)},startCallBack:function(e){this.node.on(cc.Node.EventType.MOUSE_DOWN,function(e){var t=e.getCurrentTarget();t=t.getComponent("Waiting-GoBtn"),cc.audioEngine.playEffect(t.clickAudio,!1),cc.director.loadScene("Gaming")}),this.node.on(cc.Node.EventType.TOUCH_START,function(e){var t=e.getCurrentTarget();t=t.getComponent("Waiting-GoBtn"),cc.audioEngine.playEffect(t.clickAudio,!1),cc.director.loadScene("Gaming")})}}),cc._RFpop()},{}],Waiting:[function(e,t,n){"use strict";cc._RFpush(t,"104cdXWrFhJpK8B1KMWxImA","Waiting");var a=e("CommonUserIfo");cc.Class({"extends":cc.Component,properties:{newHorse2:null,newUser:null,horseSpritePrefab:{"default":null,type:cc.Prefab},userIfoPrefab:{"default":null,type:cc.Prefab},userCount:null,winsize:null,gameData:null,MaskSprite:{"default":null,type:cc.Sprite},NumLabel:{"default":null,type:cc.Label},MessageLabel:{"default":null,type:cc.Label},BackBtn:{"default":null,type:cc.Button},BeginBtn:{"default":null,type:cc.Button}},onLoad:function(){this.winsize=this.node.width,this.gameData=JSON.parse(cc.sys.localStorage.getItem("gameData")),a.data.userNum=0,a.data.userName=null,this.webSocket()},webSocket:function(){var e=new WebSocket("ws://192.168.0.189:2200"),t=this;this.BackBtn.node.on(cc.Node.EventType.TOUCH_START,function(t){e.close()}),this.BeginBtn.node.on(cc.Node.EventType.TOUCH_START,function(t){cc.log("开赛"),e.send("BeginGame")}),e.onopen=function(e){cc.log("通讯连接成功！")},e.onmessage=function(e){var n=e.data.split("/").length/2-1;a.data.userNum=n,t.userCount=n;var c=e.data.split("/");if(cc.log(c),a.data.userName=c,"0"==e.data[0]){for(var o=0;n>o;o++)t.newHorse2=cc.instantiate(t.horseSpritePrefab),t.newUser=cc.instantiate(t.userIfoPrefab),t.newHorse2.tag=c[2*o+2],t.newUser.tag=c[2*o+2]+"user",t.newHorse2.setPosition(cc.p(-120,525+-92*o)),t.newUser.setPosition(cc.p(-410,525+-92*o)),t.newUser.children[0].getComponent(cc.Label).string="["+c[2*o+2].substr(0,8)+"]",t.node.children[1].addChild(t.newHorse2),t.node.children[1].addChild(t.newUser);"Admin"==t.gameData.user&&(t.MaskSprite.node.opacity=180,t.MaskSprite.node.zIndex=1,t.userCount<10?t.userCount="00"+t.userCount:t.userCount>=10&&t.userCount<=99&&(t.userCount="0"+t.userCount),t.NumLabel.string=t.userCount,t.MessageLabel.string="已有"+t.userCount+"位好友准备就绪")}else if("1"==e.data[0]){t.node.children[1].removeAllChildren();for(var i=0;n>i;i++)t.newHorse2=cc.instantiate(t.horseSpritePrefab),t.newUser=cc.instantiate(t.userIfoPrefab),t.newHorse2.tag=c[2*i+2],t.newUser.tag=c[2*i+2]+"user",t.newHorse2.setPosition(cc.p(-120,525+-92*i)),t.newUser.setPosition(cc.p(-410,525+-92*i)),t.newUser.children[0].getComponent(cc.Label).string="["+c[2*i+2].substr(0,8)+"]",t.node.children[1].addChild(t.newHorse2),t.node.children[1].addChild(t.newUser);"Admin"==t.gameData.user&&(t.MaskSprite.node.opacity=180,t.MaskSprite.node.zIndex=1,t.userCount<10?t.userCount="00"+t.userCount:t.userCount>=10&&t.userCount<=99&&(t.userCount="0"+t.userCount),cc.log("进入了遮罩判断代码段"),t.NumLabel.string=t.userCount,t.MessageLabel.string="已有"+t.userCount+"位好友准备就绪")}else"2"==e.data[0]&&(cc.log("data:",e.data),cc.director.loadScene("Gaming"))},e.onerror=function(e){cc.log("Send Text fired an error")},e.onclose=function(e){cc.log("WebSocket instance closed.")}},update:function(){}}),cc._RFpop()},{CommonUserIfo:"CommonUserIfo"}],horseSprite:[function(e,t,n){"use strict";cc._RFpush(t,"9132bnAbg1PW7IwOCSKHiPk","horseSprite"),cc.Class({"extends":cc.Component,properties:{xPos:0,yPos:0},onLoad:function(){var e=this.getComponent(cc.Animation),t=e.play("horseAnimation");t.repeatCount=1/0,t.speed=1.2}}),cc._RFpop()},{}]},{},["Setting-EditBox","CommonUserDis","Waiting","GameOver","Waiting-GoBtn","Setting-BacBtn","Setting-SubBtn","horseSprite","Gaming","CommonUserIfo","Index","Waiting-BacBtn"]);